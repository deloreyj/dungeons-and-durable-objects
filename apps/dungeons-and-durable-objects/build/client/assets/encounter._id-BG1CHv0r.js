import{A as g,n as e,z as x}from"./components-CR-84NmD.js";import{C as d,a as c,b as m}from"./card-DTQuCjmS.js";import{B as f}from"./button-BQyo11lN.js";import{S as b}from"./scroll-area-C1aQyH0A.js";import"./index-CulgpNTE.js";function N({cell:s,character:r}){const t={wall:"bg-gray-800",normal:"bg-white",difficult:"bg-green-500",water:"bg-blue-100",lava:"bg-red-200"},a={none:"bg-opacity-25",half:"bg-opacity-40","three-quarters":"bg-opacity-75",full:"bg-opacity-90"},n=(r==null?void 0:r.team)==="Party"?"text-blue-600":"text-red-600",i=t[s.terrain],l=s.cover?a[s.cover]:"",o=()=>{if(r)return`${r.name} (${r.race} ${r.class})`;const h=s.terrain.charAt(0).toUpperCase()+s.terrain.slice(1);if(!s.cover||s.cover==="none")return h;const j=s.cover.split("-").map(p=>p.charAt(0).toUpperCase()+p.slice(1)).join(" ");return`${h} (${j} Cover)`};return e.jsxs("div",{className:`aspect-square border border-gray-100 ${i} ${l} flex items-center justify-center relative`,title:o(),children:[r&&e.jsx(x,{to:`/character/${r.id}`,className:`text-xl font-bold ${n}`,children:r.name[0].toUpperCase()}),!r&&s.terrain!=="normal"&&e.jsxs("span",{className:"text-xs text-gray-500",children:[s.terrain==="wall"&&"■",s.terrain==="difficult"&&"▲",s.terrain==="water"&&"~",s.terrain==="lava"&&"≈"]})]})}function v({state:s}){return e.jsx("div",{className:"flex items-start",children:e.jsx("div",{className:"grid gap-0",style:{gridTemplateColumns:`repeat(${s.mapSize.width}, minmax(0, 1fr))`},children:s.map.map((r,t)=>r.map((a,n)=>{const i=a.characterId,l=i?s.characters.find(o=>o.id===i):void 0;return e.jsx(N,{cell:a,character:l},`${n}-${t}`)}))})})}function y({character:s}){return e.jsxs("div",{className:"flex items-center gap-2 p-1.5 hover:bg-gray-100 rounded",children:[s.imageUrl&&e.jsx("div",{className:"h-16 w-16 flex-shrink-0 overflow-hidden rounded border border-gray-200",children:e.jsx("img",{src:s.imageUrl,alt:s.name,className:"h-full w-full object-cover",onError:r=>{console.error("Failed to load image:",s.imageUrl),r.target.style.display="none"}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(x,{to:`/character/${s.id}`,className:"block text-sm font-medium text-gray-900 truncate hover:text-blue-600",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500 truncate",children:[s.race," ",s.class]})]})]})}function u({characters:s,team:r}){const t=s.filter(a=>a.team===r);return e.jsx(b,{className:"h-[calc(100vh-7rem)]",children:e.jsx("div",{className:"px-2 py-1 space-y-0.5",children:t.map(a=>e.jsx(y,{character:a},a.id))})})}function P(){const s=g();return s?e.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[e.jsx("header",{className:"bg-white border-b shrink-0",children:e.jsx("div",{className:"max-w-[1920px] mx-auto px-4 py-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(x,{to:"/",children:e.jsx(f,{variant:"ghost",size:"sm",children:"← Back"})}),e.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:s.name})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:[s.status," ",s.status==="IN_PROGRESS"&&`• Round ${s.round}`]}),s.status==="PREPARING"&&e.jsx(f,{size:"sm",children:"Start Encounter"})]})]})})}),e.jsx("main",{className:"flex-1 overflow-hidden",children:e.jsx("div",{className:"h-full max-w-[1920px] mx-auto px-4 py-4",children:e.jsxs("div",{className:"grid h-full grid-cols-[250px_1fr_250px] gap-4",children:[e.jsxs(d,{className:"overflow-hidden",children:[e.jsx(c,{className:"py-2 px-4 border-b",children:e.jsx("h2",{className:"text-sm font-semibold text-blue-600",children:"Party Members"})}),e.jsx(m,{className:"p-0",children:e.jsx(u,{characters:s.characters,team:"Party"})})]}),e.jsxs(d,{className:"overflow-hidden",children:[e.jsx(c,{className:"py-2 px-4 border-b",children:e.jsx("h2",{className:"text-sm font-semibold",children:"Battlefield"})}),e.jsx(m,{className:"p-2 h-full",children:e.jsx(v,{state:s})})]}),e.jsxs(d,{className:"overflow-hidden",children:[e.jsx(c,{className:"py-2 px-4 border-b",children:e.jsx("h2",{className:"text-sm font-semibold text-red-600",children:"Enemies"})}),e.jsx(m,{className:"p-0",children:e.jsx(u,{characters:s.characters,team:"Enemies"})})]})]})})})]}):e.jsx("div",{children:"Loading..."})}export{P as default};
