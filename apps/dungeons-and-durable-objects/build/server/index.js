import{jsx as e,jsxs as r}from"react/jsx-runtime";import{RemixServer as Z,Outlet as K,Meta as X,Links as ee,ScrollRestoration as ae,Scripts as te,useActionData as re,Link as v,Form as se,useLoaderData as k,useNavigate as ne}from"@remix-run/react";import{isbot as le}from"isbot";import{renderToReadableStream as oe}from"react-dom/server";import*as d from"react";import{useEffect as z,useState as ie}from"react";import{Slot as ce}from"@radix-ui/react-slot";import{cva as H}from"class-variance-authority";import{clsx as de}from"clsx";import{twMerge as me}from"tailwind-merge";import*as F from"@radix-ui/react-label";import*as i from"@radix-ui/react-select";import{ChevronDown as V,ChevronUp as he,Check as ue}from"lucide-react";import{json as Q}from"@remix-run/node";import*as C from"@radix-ui/react-scroll-area";const M=5e3;async function pe(a,t,s,l,m){const h=new AbortController,p=setTimeout(()=>h.abort(),M),g=await oe(e(Z,{context:l,url:a.url,abortDelay:M}),{signal:h.signal,onError(N){h.signal.aborted||console.error(N),t=500}});return g.allReady.then(()=>clearTimeout(p)),le(a.headers.get("user-agent")||"")&&await g.allReady,s.set("Content-Type","text/html"),new Response(g,{headers:s,status:t})}function fe(a,{request:t}){console.error(`in this method ${t.method} ${t.url}`),console.error(`here is the error: ${JSON.stringify(a.message,null,2)}`)}const ge=Object.freeze(Object.defineProperty({__proto__:null,default:pe,handleError:fe},Symbol.toStringTag,{value:"Module"})),ye=()=>[{rel:"preconnect",href:"https://fonts.googleapis.com"},{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"anonymous"},{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"}];function be({children:a}){return r("html",{lang:"en",children:[r("head",{children:[e("meta",{charSet:"utf-8"}),e("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),e(X,{}),e(ee,{})]}),r("body",{children:[a,e(ae,{}),e(te,{})]})]})}function xe(){return e(K,{})}const ve=Object.freeze(Object.defineProperty({__proto__:null,Layout:be,default:xe,links:ye},Symbol.toStringTag,{value:"Module"}));function c(...a){return me(de(a))}const Ne=H("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),f=d.forwardRef(({className:a,variant:t,size:s,asChild:l=!1,...m},h)=>e(l?ce:"button",{className:c(Ne({variant:t,size:s,className:a})),ref:h,...m}));f.displayName="Button";const y=d.forwardRef(({className:a,...t},s)=>e("div",{ref:s,className:c("rounded-xl border bg-card text-card-foreground shadow",a),...t}));y.displayName="Card";const b=d.forwardRef(({className:a,...t},s)=>e("div",{ref:s,className:c("flex flex-col space-y-1.5 p-6",a),...t}));b.displayName="CardHeader";const we=d.forwardRef(({className:a,...t},s)=>e("div",{ref:s,className:c("font-semibold leading-none tracking-tight",a),...t}));we.displayName="CardTitle";const Ce=d.forwardRef(({className:a,...t},s)=>e("div",{ref:s,className:c("text-sm text-muted-foreground",a),...t}));Ce.displayName="CardDescription";const x=d.forwardRef(({className:a,...t},s)=>e("div",{ref:s,className:c("p-6 pt-0",a),...t}));x.displayName="CardContent";const Se=d.forwardRef(({className:a,...t},s)=>e("div",{ref:s,className:c("flex items-center p-6 pt-0",a),...t}));Se.displayName="CardFooter";const q=d.forwardRef(({className:a,type:t,...s},l)=>e("input",{type:t,className:c("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:l,...s}));q.displayName="Input";const T=d.forwardRef(({className:a,...t},s)=>e("textarea",{className:c("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...t}));T.displayName="Textarea";const je=H("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),w=d.forwardRef(({className:a,...t},s)=>e(F.Root,{ref:s,className:c(je(),a),...t}));w.displayName=F.Root.displayName;const B=i.Root,E=i.Value,A=d.forwardRef(({className:a,children:t,...s},l)=>r(i.Trigger,{ref:l,className:c("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...s,children:[t,e(i.Icon,{asChild:!0,children:e(V,{className:"h-4 w-4 opacity-50"})})]}));A.displayName=i.Trigger.displayName;const G=d.forwardRef(({className:a,...t},s)=>e(i.ScrollUpButton,{ref:s,className:c("flex cursor-default items-center justify-center py-1",a),...t,children:e(he,{className:"h-4 w-4"})}));G.displayName=i.ScrollUpButton.displayName;const J=d.forwardRef(({className:a,...t},s)=>e(i.ScrollDownButton,{ref:s,className:c("flex cursor-default items-center justify-center py-1",a),...t,children:e(V,{className:"h-4 w-4"})}));J.displayName=i.ScrollDownButton.displayName;const I=d.forwardRef(({className:a,children:t,position:s="popper",...l},m)=>e(i.Portal,{children:r(i.Content,{ref:m,className:c("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:s,...l,children:[e(G,{}),e(i.Viewport,{className:c("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e(J,{})]})}));I.displayName=i.Content.displayName;const _e=d.forwardRef(({className:a,...t},s)=>e(i.Label,{ref:s,className:c("px-2 py-1.5 text-sm font-semibold",a),...t}));_e.displayName=i.Label.displayName;const o=d.forwardRef(({className:a,children:t,...s},l)=>r(i.Item,{ref:l,className:c("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...s,children:[e("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e(i.ItemIndicator,{children:e(ue,{className:"h-4 w-4"})})}),e(i.ItemText,{children:t})]}));o.displayName=i.Item.displayName;const Re=d.forwardRef(({className:a,...t},s)=>e(i.Separator,{ref:s,className:c("-mx-1 my-1 h-px bg-muted",a),...t}));Re.displayName=i.Separator.displayName;async function Ae({request:a,context:t}){const s=await a.formData(),l=s.get("name"),m=s.get("backstory"),h=s.get("alignment"),p=s.get("appearance"),g=s.get("characterClass"),N=s.get("race");return(await fetch(`${t.cloudflare.env.API_BASE_URL}/character`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:l,backstory:m,alignment:h,appearance:p,characterClass:g,race:N})})).json()}function Ie(){const a=re();return e("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:r("div",{className:"max-w-3xl mx-auto",children:[e("div",{className:"flex items-center justify-between mb-8",children:e(v,{to:"/",children:e(f,{variant:"ghost",className:"text-gray-600 hover:text-gray-900",children:"← Back"})})}),r(y,{className:"shadow-xl border-0",children:[r(b,{className:"space-y-1 pb-8 border-b",children:[e("h1",{className:"text-3xl font-bold tracking-tight",children:"Create Character"}),e("p",{className:"text-sm text-muted-foreground",children:"Create your D&D character"})]}),r(x,{className:"pt-6",children:[r(se,{method:"post",className:"space-y-8",children:[r("div",{className:"space-y-2",children:[e(w,{htmlFor:"name",children:"Character Name"}),e(q,{id:"name",name:"name",required:!0,defaultValue:"Thorin Oakenslayer"})]}),r("div",{className:"space-y-2",children:[e(w,{htmlFor:"race",children:"Race"}),r(B,{name:"race",required:!0,defaultValue:"Dwarf",children:[e(A,{children:e(E,{placeholder:"Select race"})}),r(I,{children:[e(o,{value:"Human",children:"Human"}),e(o,{value:"Elf",children:"Elf"}),e(o,{value:"Dwarf",children:"Dwarf"}),e(o,{value:"Halfling",children:"Halfling"}),e(o,{value:"Gnome",children:"Gnome"}),e(o,{value:"Half-Elf",children:"Half-Elf"}),e(o,{value:"Half-Orc",children:"Half-Orc"}),e(o,{value:"Tiefling",children:"Tiefling"})]})]})]}),r("div",{className:"space-y-2",children:[e(w,{htmlFor:"characterClass",children:"Class"}),r(B,{name:"characterClass",required:!0,defaultValue:"Fighter",children:[e(A,{children:e(E,{placeholder:"Select class"})}),r(I,{children:[e(o,{value:"Barbarian",children:"Barbarian"}),e(o,{value:"Cleric",children:"Cleric"}),e(o,{value:"Fighter",children:"Fighter"}),e(o,{value:"Sorcerer",children:"Sorcerer"})]})]})]}),r("div",{className:"space-y-2",children:[e(w,{htmlFor:"alignment",children:"Alignment"}),r(B,{name:"alignment",required:!0,defaultValue:"lawful_good",children:[e(A,{children:e(E,{placeholder:"Select alignment"})}),r(I,{children:[e(o,{value:"lawful_good",children:"Lawful Good"}),e(o,{value:"neutral_good",children:"Neutral Good"}),e(o,{value:"chaotic_good",children:"Chaotic Good"}),e(o,{value:"lawful_neutral",children:"Lawful Neutral"}),e(o,{value:"true_neutral",children:"True Neutral"}),e(o,{value:"chaotic_neutral",children:"Chaotic Neutral"}),e(o,{value:"lawful_evil",children:"Lawful Evil"}),e(o,{value:"neutral_evil",children:"Neutral Evil"}),e(o,{value:"chaotic_evil",children:"Chaotic Evil"})]})]})]}),r("div",{className:"space-y-2",children:[e(w,{htmlFor:"appearance",children:"Physical Description"}),e(T,{id:"appearance",name:"appearance",required:!0,placeholder:"Describe your character's physical appearance",className:"min-h-[100px]",defaultValue:"A stout dwarf with a braided beard adorned with golden rings. Wears heavy plate armor and carries a mighty warhammer."})]}),r("div",{className:"space-y-2",children:[e(w,{htmlFor:"backstory",children:"Backstory"}),e(T,{id:"backstory",name:"backstory",required:!0,placeholder:"Write your character's background story",className:"min-h-[200px]",defaultValue:"Born to a noble dwarven family in the mountain fortress of Khazad-dûm, Thorin trained from youth in the arts of war and leadership. After his clan was driven from their home by a ancient dragon, he now seeks to reclaim his ancestral halls and restore his family's honor."})]}),e(f,{type:"submit",size:"lg",className:"w-full",children:"Create Character"})]}),(a==null?void 0:a.success)&&r("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 text-green-700 rounded-lg",children:[r("p",{className:"mb-4",children:["Character created successfully! Your character ID is:"," ",e("code",{className:"bg-green-100 px-2 py-1 rounded",children:a.characterId})]}),e(v,{to:`/character/${a.characterId}`,children:e(f,{variant:"outline",className:"w-full",children:"View Character Sheet"})})]})]})]})]})})}const De=Object.freeze(Object.defineProperty({__proto__:null,action:Ae,default:Ie},Symbol.toStringTag,{value:"Module"}));async function Be({context:a}){console.log("Creating encounter"),console.log("Context:",a);const t=`${a.cloudflare.env.API_BASE_URL}/encounter`;console.log("URL:",t);const s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"}});console.log("Response:",s.ok),console.log("Response:",s.status),console.log("Response:",s.statusText);const l=await s.json();return console.log("Data:",l),Q(l)}function Ee(){const a=k();return z(()=>{if(a!=null&&a.encounterID){const t=JSON.parse(localStorage.getItem("encounters")||"[]"),s={id:a.encounterID,name:"New Encounter"};t.push(s),localStorage.setItem("encounters",JSON.stringify(t))}},[a==null?void 0:a.encounterID]),a!=null&&a.encounterID?e("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:r("div",{className:"max-w-3xl mx-auto",children:[e("div",{className:"flex items-center justify-between mb-8",children:e(v,{to:"/",children:e(f,{variant:"ghost",className:"text-gray-600 hover:text-gray-900",children:"← Back"})})}),r(y,{className:"shadow-xl border-0",children:[r(b,{className:"space-y-1 pb-8 border-b",children:[e("h1",{className:"text-3xl font-bold tracking-tight",children:"Encounter Created!"}),e("p",{className:"text-sm text-muted-foreground",children:"Share this ID with your players to join the encounter"})]}),e(x,{className:"pt-6",children:r("div",{className:"space-y-6",children:[r("div",{className:"p-4 bg-green-50 border border-green-200 text-green-700 rounded-lg",children:[e("p",{className:"font-medium",children:"Your encounter ID is:"}),e("p",{className:"text-2xl font-mono mt-2",children:a.encounterID})]}),r("div",{className:"space-y-4",children:[e("p",{className:"text-gray-600",children:"To join this encounter:"}),r("ol",{className:"list-decimal list-inside space-y-2 text-gray-600",children:[e("li",{children:"Share this ID with your players"}),e("li",{children:'Have them navigate to the "Join Encounter" page'}),e("li",{children:"Enter this ID to join the encounter"})]})]}),e("div",{className:"flex gap-4",children:e(f,{asChild:!0,className:"w-full",children:e(v,{to:`/encounter/${a.encounterID}`,children:"Go to Encounter"})})})]})})]})]})}):e("div",{children:"Error creating encounter"})}const Te=Object.freeze(Object.defineProperty({__proto__:null,default:Ee,loader:Be},Symbol.toStringTag,{value:"Module"}));async function ke({params:a,context:t}){if(!a.name)throw new Response("Character name is required",{status:400});const s=await fetch(`${t.cloudflare.env.API_BASE_URL}/character?name=${a.name}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Response("Character not found",{status:404});const l=await s.json();if(!l||!l.stats)throw new Response("Invalid character data",{status:500});const m=`${t.cloudflare.env.API_BASE_URL}/characters/${encodeURIComponent(a.name)}/image`;return Response.json({character:l,imageUrl:m})}function S({label:a,value:t}){const s=Math.floor((t-10)/2);return r("div",{className:"text-center p-4 border rounded-lg",children:[e("div",{className:"text-sm text-gray-600",children:a}),e("div",{className:"text-2xl font-bold",children:t}),e("div",{className:"text-sm",children:s>=0?`+${s}`:s})]})}function $e(){var m,h,p,g,N,j,_,L,O;const a=k(),{character:t,imageUrl:s}=a,l=ne();return!t||!t.stats?e("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e("div",{className:"max-w-4xl mx-auto text-center",children:e("h2",{className:"text-2xl font-bold text-gray-900",children:"Character data is invalid"})})}):(console.log(t),e("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:r("div",{className:"max-w-4xl mx-auto",children:[e("div",{className:"flex items-center justify-between mb-8",children:e(f,{variant:"ghost",className:"text-gray-600 hover:text-gray-900",onClick:()=>l(-1),children:"← Back"})}),r("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r(y,{className:"md:col-span-1",children:[r(b,{children:[e("h2",{className:"text-2xl font-bold",children:t.name}),r("p",{className:"text-sm text-gray-600",children:["Level ",t.level," ",t.race," ",t.characterClass]})]}),r(x,{children:[e("img",{src:s,alt:t.name,className:"w-full h-auto rounded-lg shadow-lg mb-4",onError:n=>{console.error("Failed to load image"),n.currentTarget.style.display="none"}}),r("div",{className:"space-y-2",children:[r("p",{children:[e("strong",{children:"Alignment:"})," ",t.alignment]}),r("p",{children:[e("strong",{children:"Speed:"})," ",t.speed," ft."]}),r("p",{children:[e("strong",{children:"Initiative:"})," ",t.initiativeModifier>=0?"+":"",t.initiativeModifier]}),r("p",{children:[e("strong",{children:"Armor Class:"})," ",((m=t.armor)==null?void 0:m.baseAC)+((h=t.armor)!=null&&h.isShieldEquipped?2:0)+((p=t.armor)==null?void 0:p.magicBonus)]})]}),(((g=t.actions)==null?void 0:g.length)>0||((N=t.bonusActions)==null?void 0:N.length)>0)&&r("div",{className:"mt-4 space-y-4",children:[((j=t.actions)==null?void 0:j.length)>0&&r("div",{children:[e("h3",{className:"font-semibold mb-2",children:"Actions"}),e("div",{className:"space-y-2",children:(_=t.actions)==null?void 0:_.map((n,u)=>r("div",{className:"text-sm",children:[e("p",{className:"font-medium",children:n.name}),n.type==="weapon"&&n.damage&&r("p",{className:"text-gray-600",children:["Attack: ",n.attackBonus&&(n.attackBonus>=0?"+":""),n.attackBonus," | Damage: ",n.damage.diceCount,"d",n.damage.diceType," + ",n.damage.modifier," ",n.damage.type]}),n.description&&e("p",{className:"text-gray-600",children:n.description})]},u))})]}),((L=t.bonusActions)==null?void 0:L.length)>0&&r("div",{children:[e("h3",{className:"font-semibold mb-2",children:"Bonus Actions"}),e("div",{className:"space-y-2",children:(O=t.bonusActions)==null?void 0:O.map((n,u)=>r("div",{className:"text-sm",children:[e("p",{className:"font-medium",children:n.name}),n.type==="weapon"&&n.damage&&r("p",{className:"text-gray-600",children:["Attack: ",n.attackBonus&&(n.attackBonus>=0?"+":""),n.attackBonus," | Damage: ",n.damage.diceCount,"d",n.damage.diceType," + ",n.damage.modifier," ",n.damage.type]}),n.description&&e("p",{className:"text-gray-600",children:n.description})]},u))})]})]})]})]}),r(y,{className:"md:col-span-1",children:[e(b,{children:e("h2",{className:"text-xl font-bold",children:"Abilities"})}),r(x,{children:[r("div",{className:"grid grid-cols-2 gap-4",children:[e(S,{label:"Strength",value:t.stats.strength}),e(S,{label:"Dexterity",value:t.stats.dexterity}),e(S,{label:"Constitution",value:t.stats.constitution}),e(S,{label:"Intelligence",value:t.stats.intelligence}),e(S,{label:"Wisdom",value:t.stats.wisdom}),e(S,{label:"Charisma",value:t.stats.charisma})]}),e("div",{className:"mt-6 p-4 border rounded-lg",children:r("div",{className:"text-center",children:[e("div",{className:"text-sm text-gray-600",children:"Hit Points"}),r("div",{className:"text-2xl font-bold",children:[t.currentHp," / ",t.maxHp]})]})})]})]}),r(y,{className:"md:col-span-1",children:[e(b,{children:e("h2",{className:"text-xl font-bold",children:"Proficiencies & Skills"})}),e(x,{children:r("div",{className:"space-y-4",children:[r("div",{children:[e("h3",{className:"font-semibold mb-2",children:"Saving Throws"}),e("div",{className:"space-y-1",children:Object.entries(t.savingThrows).map(([n,u])=>{const P=t.stats[n.toLowerCase()],R=Math.floor((P-10)/2)+(u?t.proficiencyBonus:0);return r("div",{className:"flex items-center justify-between",children:[e("span",{className:u?"font-semibold":"text-gray-600",children:n.charAt(0).toUpperCase()+n.slice(1)}),e("span",{className:u?"font-semibold":"text-gray-600",children:R>=0?`+${R}`:R})]},n)})})]}),r("div",{children:[e("h3",{className:"font-semibold mb-2",children:"Skills"}),e("div",{className:"space-y-1",children:Object.entries(t.skills).map(([n,u])=>{const R={acrobatics:"dexterity",animalHandling:"wisdom",arcana:"intelligence",athletics:"strength",deception:"charisma",history:"intelligence",insight:"wisdom",intimidation:"charisma",investigation:"intelligence",medicine:"wisdom",nature:"intelligence",perception:"wisdom",performance:"charisma",persuasion:"charisma",religion:"intelligence",sleightOfHand:"dexterity",stealth:"dexterity",survival:"wisdom"}[n],Y=t.stats[R],D=Math.floor((Y-10)/2)+(u?t.proficiencyBonus:0);return r("div",{className:"flex items-center justify-between",children:[e("span",{className:u?"font-semibold":"text-gray-600",children:n.replace(/([A-Z])/g," $1").trim().charAt(0).toUpperCase()+n.replace(/([A-Z])/g," $1").trim().slice(1)}),e("span",{className:u?"font-semibold":"text-gray-600",children:D>=0?`+${D}`:D})]},n)})})]})]})})]}),r(y,{className:"md:col-span-3",children:[e(b,{children:e("h2",{className:"text-xl font-bold",children:"Background"})}),e(x,{children:r("div",{className:"space-y-4",children:[r("div",{children:[e("h3",{className:"font-semibold",children:"Appearance"}),e("p",{className:"text-gray-700",children:t.appearance})]}),r("div",{children:[e("h3",{className:"font-semibold",children:"Backstory"}),e("p",{className:"text-gray-700",children:t.backstory})]})]})})]}),r(y,{className:"md:col-span-3",children:[e(b,{children:e("h2",{className:"text-xl font-bold",children:"Equipment & Conditions"})}),e(x,{children:r("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r("div",{children:[e("h3",{className:"font-semibold mb-2",children:"Inventory"}),e("ul",{className:"list-disc list-inside text-gray-700",children:t.inventory.map((n,u)=>e("li",{children:n},u))})]}),r("div",{children:[e("h3",{className:"font-semibold mb-2",children:"Active Conditions"}),e("ul",{className:"list-disc list-inside text-gray-700",children:Array.from(t.conditions).map((n,u)=>e("li",{children:n},u))})]})]})})]})]})]})}))}const Le=Object.freeze(Object.defineProperty({__proto__:null,default:$e,loader:ke},Symbol.toStringTag,{value:"Module"}));function Oe(){return r("div",{className:"p-4",children:[e(v,{to:"/",className:"mb-8 inline-block",children:e(f,{variant:"outline",children:"← Back"})}),e("h1",{className:"text-4xl font-bold mt-4",children:"Join Encounter"})]})}const Pe=Object.freeze(Object.defineProperty({__proto__:null,default:Oe},Symbol.toStringTag,{value:"Module"})),$=d.forwardRef(({className:a,children:t,...s},l)=>r(C.Root,{ref:l,className:c("relative overflow-hidden",a),...s,children:[e(C.Viewport,{className:"h-full w-full rounded-[inherit]",children:t}),e(W,{}),e(C.Corner,{})]}));$.displayName=C.Root.displayName;const W=d.forwardRef(({className:a,orientation:t="vertical",...s},l)=>e(C.ScrollAreaScrollbar,{ref:l,orientation:t,className:c("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...s,children:e(C.ScrollAreaThumb,{className:"relative flex-1 rounded-full bg-border"})}));W.displayName=C.ScrollAreaScrollbar.displayName;async function Me({params:a,context:t}){const s=await fetch(`${t.cloudflare.env.API_BASE_URL}/encounter/${a.id}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error("Failed to load encounter");const l=await s.json(),m=l.characters.map(p=>({...p,imageUrl:`${t.cloudflare.env.API_BASE_URL}/characters/${encodeURIComponent(p.id)}/image`})),h={...l,characters:m};return Q(h)}function Ue({cell:a,character:t}){const s={wall:"bg-gray-800",normal:"bg-white",difficult:"bg-green-500",water:"bg-blue-100",lava:"bg-red-200"},l={none:"bg-opacity-25",half:"bg-opacity-40","three-quarters":"bg-opacity-75",full:"bg-opacity-90"},m=(t==null?void 0:t.team)==="Party"?"text-blue-600":"text-red-600",h=s[a.terrain],p=a.cover?l[a.cover]:"",g=()=>{if(t)return`${t.name} (${t.race} ${t.class})`;const N=a.terrain.charAt(0).toUpperCase()+a.terrain.slice(1);if(!a.cover||a.cover==="none")return N;const j=a.cover.split("-").map(_=>_.charAt(0).toUpperCase()+_.slice(1)).join(" ");return`${N} (${j} Cover)`};return r("div",{className:`aspect-square border border-gray-100 ${h} ${p} flex items-center justify-center relative`,title:g(),children:[t&&e(v,{to:`/character/${t.id}`,className:`text-xl font-bold ${m}`,children:t.name[0].toUpperCase()}),!t&&a.terrain!=="normal"&&r("span",{className:"text-xs text-gray-500",children:[a.terrain==="wall"&&"■",a.terrain==="difficult"&&"▲",a.terrain==="water"&&"~",a.terrain==="lava"&&"≈"]})]})}function ze({state:a}){return e("div",{className:"flex items-start",children:e("div",{className:"grid gap-0",style:{gridTemplateColumns:`repeat(${a.mapSize.width}, minmax(0, 1fr))`},children:a.map.map((t,s)=>t.map((l,m)=>{const h=l.characterId,p=h?a.characters.find(g=>g.id===h):void 0;return e(Ue,{cell:l,character:p},`${m}-${s}`)}))})})}function He({character:a}){return r("div",{className:"flex items-center gap-2 p-1.5 hover:bg-gray-100 rounded",children:[a.imageUrl&&e("div",{className:"h-16 w-16 flex-shrink-0 overflow-hidden rounded border border-gray-200",children:e("img",{src:a.imageUrl,alt:a.name,className:"h-full w-full object-cover",onError:t=>{console.error("Failed to load image:",a.imageUrl),t.target.style.display="none"}})}),r("div",{className:"flex-1 min-w-0",children:[e(v,{to:`/character/${a.id}`,className:"block text-sm font-medium text-gray-900 truncate hover:text-blue-600",children:a.name}),r("p",{className:"text-xs text-gray-500 truncate",children:[a.race," ",a.class]})]})]})}function U({characters:a,team:t}){const s=a.filter(l=>l.team===t);return e($,{className:"h-[calc(100vh-7rem)]",children:e("div",{className:"px-2 py-1 space-y-0.5",children:s.map(l=>e(He,{character:l},l.id))})})}function Fe(){const a=k();return a?r("div",{className:"h-screen flex flex-col bg-gray-50",children:[e("header",{className:"bg-white border-b shrink-0",children:e("div",{className:"max-w-[1920px] mx-auto px-4 py-2",children:r("div",{className:"flex items-center justify-between",children:[r("div",{className:"flex items-center gap-3",children:[e(v,{to:"/",children:e(f,{variant:"ghost",size:"sm",children:"← Back"})}),e("h1",{className:"text-lg font-semibold text-gray-900",children:a.name})]}),r("div",{className:"flex items-center gap-4",children:[r("p",{className:"text-sm text-gray-500",children:[a.status," ",a.status==="IN_PROGRESS"&&`• Round ${a.round}`]}),a.status==="PREPARING"&&e(f,{size:"sm",children:"Start Encounter"})]})]})})}),e("main",{className:"flex-1 overflow-hidden",children:e("div",{className:"h-full max-w-[1920px] mx-auto px-4 py-4",children:r("div",{className:"grid h-full grid-cols-[250px_1fr_250px] gap-4",children:[r(y,{className:"overflow-hidden",children:[e(b,{className:"py-2 px-4 border-b",children:e("h2",{className:"text-sm font-semibold text-blue-600",children:"Party Members"})}),e(x,{className:"p-0",children:e(U,{characters:a.characters,team:"Party"})})]}),r(y,{className:"overflow-hidden",children:[e(b,{className:"py-2 px-4 border-b",children:e("h2",{className:"text-sm font-semibold",children:"Battlefield"})}),e(x,{className:"p-2 h-full",children:e(ze,{state:a})})]}),r(y,{className:"overflow-hidden",children:[e(b,{className:"py-2 px-4 border-b",children:e("h2",{className:"text-sm font-semibold text-red-600",children:"Enemies"})}),e(x,{className:"p-0",children:e(U,{characters:a.characters,team:"Enemies"})})]})]})})})]}):e("div",{children:"Loading..."})}const Ve=Object.freeze(Object.defineProperty({__proto__:null,default:Fe,loader:Me},Symbol.toStringTag,{value:"Module"}));function Qe(){const[a,t]=ie([]);return z(()=>{const s=JSON.parse(localStorage.getItem("encounters")||"[]");t(s)},[]),a.length===0?null:r(y,{className:"w-full max-w-md mt-8",children:[e(b,{children:e("h2",{className:"text-xl font-semibold",children:"My Encounters"})}),e(x,{children:e($,{className:"h-[300px]",children:e("div",{className:"space-y-2",children:a.map(s=>e(v,{to:`/encounter/${s.id}`,className:"block p-3 hover:bg-gray-100 rounded-lg",children:r("div",{className:"flex justify-between items-center",children:[e("span",{className:"font-medium",children:s.name}),e("span",{className:"text-sm text-gray-500",children:s.status})]})},s.id))})})})]})}const qe=()=>[{title:"Dungeons & Durable Objects"},{name:"description",content:"A D&D companion app built with Cloudflare Durable Objects"}];function Ge(){return r("div",{className:"font-sans p-4 flex flex-col items-center",children:[e("h1",{className:"text-4xl font-bold mb-8",children:"Dungeons & Durable Objects"}),r("div",{className:"flex flex-col gap-4 w-48",children:[e(v,{to:"/create-encounter",className:"w-full",children:e(f,{className:"w-full",children:"Create Encounter"})}),e(v,{to:"/create-character",className:"w-full",children:e(f,{className:"w-full",children:"Create Character"})}),e(v,{to:"/join-encounter",className:"w-full",children:e(f,{className:"w-full",children:"Join Encounter"})})]}),e(Qe,{})]})}const Je=Object.freeze(Object.defineProperty({__proto__:null,default:Ge,meta:qe},Symbol.toStringTag,{value:"Module"})),la={entry:{module:"/assets/entry.client-CBo9Yohi.js",imports:["/assets/components-CR-84NmD.js"],css:[]},routes:{root:{id:"root",parentId:void 0,path:"",index:void 0,caseSensitive:void 0,hasAction:!1,hasLoader:!1,hasClientAction:!1,hasClientLoader:!1,hasErrorBoundary:!1,module:"/assets/root-DZ94dg0m.js",imports:["/assets/components-CR-84NmD.js"],css:["/assets/root-Bk2JcRir.css"]},"routes/create-character":{id:"routes/create-character",parentId:"root",path:"create-character",index:void 0,caseSensitive:void 0,hasAction:!0,hasLoader:!1,hasClientAction:!1,hasClientLoader:!1,hasErrorBoundary:!1,module:"/assets/create-character-K3y9bqT4.js",imports:["/assets/components-CR-84NmD.js","/assets/button-BQyo11lN.js","/assets/card-DTQuCjmS.js","/assets/index-CulgpNTE.js"],css:[]},"routes/create-encounter":{id:"routes/create-encounter",parentId:"root",path:"create-encounter",index:void 0,caseSensitive:void 0,hasAction:!1,hasLoader:!0,hasClientAction:!1,hasClientLoader:!1,hasErrorBoundary:!1,module:"/assets/create-encounter-DIewXI8L.js",imports:["/assets/components-CR-84NmD.js","/assets/button-BQyo11lN.js","/assets/card-DTQuCjmS.js"],css:[]},"routes/character.$name":{id:"routes/character.$name",parentId:"root",path:"character/:name",index:void 0,caseSensitive:void 0,hasAction:!1,hasLoader:!0,hasClientAction:!1,hasClientLoader:!1,hasErrorBoundary:!1,module:"/assets/character._name-kX-ldlEm.js",imports:["/assets/components-CR-84NmD.js","/assets/card-DTQuCjmS.js","/assets/button-BQyo11lN.js"],css:[]},"routes/join-encounter":{id:"routes/join-encounter",parentId:"root",path:"join-encounter",index:void 0,caseSensitive:void 0,hasAction:!1,hasLoader:!1,hasClientAction:!1,hasClientLoader:!1,hasErrorBoundary:!1,module:"/assets/join-encounter-DJ_ZPikn.js",imports:["/assets/components-CR-84NmD.js","/assets/button-BQyo11lN.js"],css:[]},"routes/encounter.$id":{id:"routes/encounter.$id",parentId:"root",path:"encounter/:id",index:void 0,caseSensitive:void 0,hasAction:!1,hasLoader:!0,hasClientAction:!1,hasClientLoader:!1,hasErrorBoundary:!1,module:"/assets/encounter._id-BG1CHv0r.js",imports:["/assets/components-CR-84NmD.js","/assets/card-DTQuCjmS.js","/assets/button-BQyo11lN.js","/assets/scroll-area-C1aQyH0A.js","/assets/index-CulgpNTE.js"],css:[]},"routes/_index":{id:"routes/_index",parentId:"root",path:void 0,index:!0,caseSensitive:void 0,hasAction:!1,hasLoader:!1,hasClientAction:!1,hasClientLoader:!1,hasErrorBoundary:!1,module:"/assets/_index-BcRHhnw-.js",imports:["/assets/components-CR-84NmD.js","/assets/button-BQyo11lN.js","/assets/card-DTQuCjmS.js","/assets/scroll-area-C1aQyH0A.js","/assets/index-CulgpNTE.js"],css:[]}},url:"/assets/manifest-f45f2441.js",version:"f45f2441"},oa="production",ia="build/client",ca="/",da={v3_fetcherPersist:!0,v3_relativeSplatPath:!0,v3_throwAbortReason:!0,v3_routeConfig:!1,v3_singleFetch:!0,v3_lazyRouteDiscovery:!0,unstable_optimizeDeps:!1},ma=!1,ha="/",ua={module:ge},pa={root:{id:"root",parentId:void 0,path:"",index:void 0,caseSensitive:void 0,module:ve},"routes/create-character":{id:"routes/create-character",parentId:"root",path:"create-character",index:void 0,caseSensitive:void 0,module:De},"routes/create-encounter":{id:"routes/create-encounter",parentId:"root",path:"create-encounter",index:void 0,caseSensitive:void 0,module:Te},"routes/character.$name":{id:"routes/character.$name",parentId:"root",path:"character/:name",index:void 0,caseSensitive:void 0,module:Le},"routes/join-encounter":{id:"routes/join-encounter",parentId:"root",path:"join-encounter",index:void 0,caseSensitive:void 0,module:Pe},"routes/encounter.$id":{id:"routes/encounter.$id",parentId:"root",path:"encounter/:id",index:void 0,caseSensitive:void 0,module:Ve},"routes/_index":{id:"routes/_index",parentId:"root",path:void 0,index:!0,caseSensitive:void 0,module:Je}};export{la as assets,ia as assetsBuildDirectory,ca as basename,ua as entry,da as future,ma as isSpaMode,oa as mode,ha as publicPath,pa as routes};
